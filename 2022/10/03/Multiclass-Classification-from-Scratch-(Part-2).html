<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Multi Class Classification From Scratch (Part 2) | WELCOME :)</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Multi Class Classification From Scratch (Part 2)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="BSc. in Electrical and Electronics Engineering (UG)" />
<meta property="og:description" content="BSc. in Electrical and Electronics Engineering (UG)" />
<link rel="canonical" href="https://kavindu404.github.io/Blog/2022/10/03/Multiclass-Classification-from-Scratch-(Part-2).html" />
<meta property="og:url" content="https://kavindu404.github.io/Blog/2022/10/03/Multiclass-Classification-from-Scratch-(Part-2).html" />
<meta property="og:site_name" content="WELCOME :)" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-10-03T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Multi Class Classification From Scratch (Part 2)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-03T00:00:00-05:00","datePublished":"2022-10-03T00:00:00-05:00","description":"BSc. in Electrical and Electronics Engineering (UG)","headline":"Multi Class Classification From Scratch (Part 2)","mainEntityOfPage":{"@type":"WebPage","@id":"https://kavindu404.github.io/Blog/2022/10/03/Multiclass-Classification-from-Scratch-(Part-2).html"},"url":"https://kavindu404.github.io/Blog/2022/10/03/Multiclass-Classification-from-Scratch-(Part-2).html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/Blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://kavindu404.github.io/Blog/feed.xml" title="WELCOME :)" /><link rel="shortcut icon" type="image/x-icon" href="/Blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/Blog/">WELCOME :)</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/Blog/about/">About Me</a><a class="page-link" href="/Blog/search/">Search</a><a class="page-link" href="/Blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Multi Class Classification From Scratch (Part 2)</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-10-03T00:00:00-05:00" itemprop="datePublished">
        Oct 3, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/Kavindu404/Blog/tree/master/_notebooks/2022-10-03-Multiclass -Classification -from -Scratch -(Part 2).ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/Blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/Kavindu404/Blog/master?filepath=_notebooks%2F2022-10-03-Multiclass+-Classification+-from+-Scratch+-%28Part+2%29.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/Blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/Kavindu404/Blog/blob/master/_notebooks/2022-10-03-Multiclass -Classification -from -Scratch -(Part 2).ipynb" target="_blank">
        <img class="notebook-badge-image" src="/Blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2FKavindu404%2FBlog%2Fblob%2Fmaster%2F_notebooks%2F2022-10-03-Multiclass+-Classification+-from+-Scratch+-%28Part+2%29.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/Blog/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-10-03-Multiclass -Classification -from -Scratch -(Part 2).ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Date: 25/07/2022</p>
<p>Author: @kavindu404</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Welcome to part 2 of the mini blog series on multi class classification from scratch. In first part, we used pixel similarity to predict the class of the digit. In this one, we will be building a simple neural network from scratch. Same as the last one, we start with importing fastai vision library and stacking up the data w.r.t classes like we did in the previous part.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST</span><span class="p">)</span>
<span class="n">Path</span><span class="o">.</span><span class="n">BASE_PATH</span> <span class="o">=</span> <span class="n">path</span>
<span class="n">path</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
      <progress value="15687680" class="" max="15683414" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.03% [15687680/15683414 00:01&lt;00:00]
    </div>
    
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [Path(&#39;training&#39;),Path(&#39;testing&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zeros</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="o">/</span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">ones</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="o">/</span><span class="s1">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">twos</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="o">/</span><span class="s1">&#39;2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">threes</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">fours</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="o">/</span><span class="s1">&#39;4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">fives</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="o">/</span><span class="s1">&#39;5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">sixes</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="o">/</span><span class="s1">&#39;6&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">sevens</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">eights</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="o">/</span><span class="s1">&#39;8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">nines</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="o">/</span><span class="s1">&#39;9&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stacked_zeros</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">zeros</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_ones</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">ones</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_twos</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">twos</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_threes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">threes</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_fours</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fours</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_fives</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fives</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_sixes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">sixes</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_sevens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">sevens</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_eights</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">eights</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">stacked_nines</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">nines</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">stacked_zeros</span><span class="p">,</span> <span class="n">stacked_ones</span><span class="p">,</span> <span class="n">stacked_twos</span><span class="p">,</span> <span class="n">stacked_threes</span><span class="p">,</span> <span class="n">stacked_fours</span><span class="p">,</span> <span class="n">stacked_fives</span><span class="p">,</span> <span class="n">stacked_sixes</span><span class="p">,</span> <span class="n">stacked_sevens</span><span class="p">,</span> <span class="n">stacked_eights</span><span class="p">,</span> <span class="n">stacked_nines</span><span class="p">])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
<span class="n">train_y</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">zeros</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">ones</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">twos</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">threes</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">fours</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">fives</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">sixes</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">sevens</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">eights</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">nines</span><span class="p">))</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">train_y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([60000, 784]), torch.Size([60000, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here, we create a dataset by coupling the image with its label. We do the same for the validation set.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_dset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">))</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">train_dset</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span>
<span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([784]), torch.Size([1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_zeros</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;testing&#39;</span><span class="o">/</span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">valid_ones</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;testing&#39;</span><span class="o">/</span><span class="s1">&#39;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">valid_twos</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;testing&#39;</span><span class="o">/</span><span class="s1">&#39;2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">valid_threes</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;testing&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">valid_fours</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;testing&#39;</span><span class="o">/</span><span class="s1">&#39;4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">valid_fives</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;testing&#39;</span><span class="o">/</span><span class="s1">&#39;5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">valid_sixes</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;testing&#39;</span><span class="o">/</span><span class="s1">&#39;6&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">valid_sevens</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;testing&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">valid_eights</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;testing&#39;</span><span class="o">/</span><span class="s1">&#39;8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
<span class="n">valid_nines</span> <span class="o">=</span> <span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;testing&#39;</span><span class="o">/</span><span class="s1">&#39;9&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_stacked_zeros</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">valid_zeros</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_stacked_ones</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">valid_ones</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_stacked_twos</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">valid_twos</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_stacked_threes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">valid_threes</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_stacked_fours</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">valid_fours</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_stacked_fives</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">valid_fives</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_stacked_sixes</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">valid_sixes</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_stacked_sevens</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">valid_sevens</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_stacked_eights</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">valid_eights</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
<span class="n">valid_stacked_nines</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">o</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">valid_nines</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">valid_stacked_zeros</span><span class="p">,</span> <span class="n">valid_stacked_ones</span><span class="p">,</span> <span class="n">valid_stacked_twos</span><span class="p">,</span> <span class="n">valid_stacked_threes</span><span class="p">,</span> <span class="n">valid_stacked_fours</span><span class="p">,</span> <span class="n">valid_stacked_fives</span><span class="p">,</span> <span class="n">valid_stacked_sixes</span><span class="p">,</span> <span class="n">valid_stacked_sevens</span><span class="p">,</span> <span class="n">valid_stacked_eights</span><span class="p">,</span> <span class="n">valid_stacked_nines</span><span class="p">])</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
<span class="n">valid_y</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_zeros</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_ones</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_twos</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_threes</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_fours</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_fives</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_sixes</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_sevens</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_eights</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_nines</span><span class="p">))</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">valid_x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">valid_y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([10000, 784]), torch.Size([10000, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_dset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">valid_x</span><span class="p">,</span> <span class="n">valid_y</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the FastAI book, Jeremy explain a 7-step process that we gonna follow. The steps are as below;</p>
<ol>
<li><em>Initialize</em> the weights.</li>
<li>For each image, use these weights to <em>predict</em> the class.</li>
<li>Based on these predictions, calculate how good the model is (its <em>loss</em>).</li>
<li>Calculate the <em>gradient</em>, which measures for each weight, how changing that weight would change the loss</li>
<li><em>Step</em> (that is, change) all the weights based on that calculation.</li>
<li>Go back to the step 2, and <em>repeat</em> the process.</li>
<li>Iterate until you decide to <em>stop</em> the training process (for instance, because the model is good enough or you don't want to wait any longer).</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So first, we write a function to init the weights.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">init_param</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span> <span class="k">return</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="o">*</span><span class="n">std</span><span class="p">)</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="n">init_param</span><span class="p">((</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">bias</span> <span class="o">=</span> <span class="n">init_param</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">weights</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([784, 10])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to predict the class, we need a small model. So in the following function, we take the data as input and outputs the predictions.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">linear1</span><span class="p">(</span><span class="n">xb</span><span class="p">):</span> <span class="k">return</span> <span class="n">xb</span><span class="nd">@weights</span><span class="o">+</span><span class="n">bias</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, in the next step, we need a way to calculate the loss for the predictions. There are liple loss functions available depending on the application. In this case, we need a loss function that can compute the loss in a muti-categorical problem. Softmax is the most common loss function used in such cases. It requires all the predictions to sum to 1 and it tends to push the most likely activation to a much larger value compared to others.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So now we define crossentropy loss to first apply softmax to the predictions and then to calculate the loss comparing them to the targets</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">crossentropy_loss</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
    <span class="n">activations</span> <span class="o">=</span> <span class="n">softmax</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">activations</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">inputs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">targets</span><span class="p">]</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Okay now we create dataloader objects for both training and validation sets. Note that each data point is having 784 features (28 * 28) and a corresponding label.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">train_dset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span><span class="n">yb</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">dl</span><span class="p">)</span>
<span class="n">xb</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">yb</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([256, 784]), torch.Size([256, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">valid_dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">valid_dset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's grab a subset of the training set and get their predictions</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span> <span class="o">=</span> <span class="n">train_x</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">batch</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([4, 784])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that for each input, there are 10 outputs. Once we input them to the softmax loss function, it outputs those 10 values in a way that they add up to 1 with the most probable labels with higher values.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">linear1</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<span class="n">preds</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([4, 10])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span> <span class="o">=</span> <span class="n">crossentropy_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">train_y</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span>
<span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(16.7473, grad_fn=&lt;NegBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">weights</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">weights</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">bias</span><span class="o">.</span><span class="n">grad</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([784, 10]),
 tensor(2.4328e-10),
 tensor([-9.9999e-01,  7.6655e-01,  1.7359e-07,  5.4389e-04,  5.4135e-02,
          3.6396e-07,  1.7450e-01,  4.2626e-03,  3.9071e-06,  2.6428e-07]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we put all the steps together to calculate the gradients</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">calc_grad</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">xb</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">crossentropy_loss</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we define the following function to train our model for a single epoch. It will take each batch from the data loader and will calculate the gradients. Then it will update the weights accordingly</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="ow">in</span> <span class="n">dl</span><span class="p">:</span>
        <span class="n">calc_grad</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">*</span><span class="n">lr</span>
            <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we can package them allto train for multiple epochs</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">lr</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">epochs</span><span class="p">):</span>
    <span class="n">val_acc</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="n">train_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">val_acc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">validate_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">val_acc</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We also define functions to calculate train and validation accuracies.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">batch_accuracy</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span><span class="n">yb</span><span class="p">):</span>
    <span class="n">correct</span><span class="o">=</span><span class="n">preds</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">yb</span>
    <span class="k">return</span> <span class="n">correct</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">validate_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="n">accs</span> <span class="o">=</span> <span class="p">[</span><span class="n">batch_accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">xb</span><span class="p">),</span> <span class="n">yb</span><span class="p">)</span> <span class="k">for</span> <span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="ow">in</span> <span class="n">valid_dl</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">accs</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="n">init_param</span><span class="p">((</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">bias</span> <span class="o">=</span> <span class="n">init_param</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">weights</span><span class="p">,</span><span class="n">bias</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-1</span>
<span class="n">val_acc</span><span class="o">=</span><span class="p">(</span><span class="n">train_model</span><span class="p">(</span><span class="n">linear1</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">val_acc</span><span class="p">),</span> <span class="n">val_acc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([&lt;matplotlib.lines.Line2D at 0x7f7b07cfe5f0&gt;], 0.621)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So our simple neural network is capable of classifying digits with a validation accuracy of 0.621</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/Blog/2022/10/03/Multiclass-Classification-from-Scratch-(Part-2).html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/Blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/Blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/Blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>BSc. in Electrical and Electronics Engineering (UG)</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/Kavindu404" target="_blank" title="Kavindu404"><svg class="svg-icon grey"><use xlink:href="/Blog/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
